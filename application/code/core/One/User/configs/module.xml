<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * This file is part of XNova:Legacies
 *
 * @license http://www.gnu.org/licenses/agpl-3.0.txt
 * @see http://www.xnova-ng.org/
 *
 * Copyright (c) 2009-2010, GrÃ©gory PLANCHAT <g.planchat at gmail.com>
 * All rights reserved.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * NOTICE:
 * This file is part of the core development branch, changing its contents will
 * make you unable to use the automatic updates manager. Please refer to the
 * documentation for further information about customizing XNova.
 *
 */
-->
<config>
  <default>
    <modules>
      <One_User>
        <version>0.1.2</version>
      </One_User>
    </modules>

    <system>
      <routes>
        <user>
          <type value="Zend_Controller_Router_Route" />
          <route value="user/:username/:controller/:action/*" />
          <defaults>
            <module value="One_User" />
            <controller value="account" />
            <action value="index" />
            <username value="" />
            <path value="user" />
          </defaults>
        </user>
        <user-account-login-logout>
          <type value="Zend_Controller_Router_Route_Regex" />
          <route value="account/(log(?:in(?:-ajax)?|out)(?:-post)?)" />
          <defaults>
            <module value="One_User" />
            <controller value="account" />
            <action value="login" />
          </defaults>
          <map>
            <action>1</action>
          </map>
          <reverse>account/%s</reverse>
        </user-account-login-logout>
      </routes>
    </system>

    <model>
      <user>
        <namespace>One_User_Model</namespace>
      </user>
    </model>

    <exception>
      <user>
        <namespace>One_User_Exception</namespace>
      </user>
    </exception>

    <block>
      <user>
        <namespace>One_User_Block</namespace>
      </user>
    </block>

    <resource>
      <dao>
        <user>
          <namespace>One_User_Resource_Dao</namespace>
        </user>
      </dao>
      <orm>
        <user>
          <namespace>One_User_Resource_Orm</namespace>
        </user>
      </orm>
      <dal>
        <database>
          <user>
            <namespace>One_User_Dal_Database</namespace>
            <connection>
              <read>user_read</read>
              <write>user_write</write>
              <setup>user_setup</setup>
            </connection>
          </user>
        </database>
        <entities>
          <user>
            <entity>
              <table>user_entity</table>
            </entity>
            <authentication>
              <table>user_authentication</table>
            </authentication>
          </user>
        </entities>
      </dal>
    </resource>
    <general>
      <database>
        <connection>
          <user_setup>
            <use>core_setup</use>
          </user_setup>
          <user_read>
            <use>core_read</use>
          </user_read>
          <user_write>
            <use>core_write</use>
          </user_write>
        </connection>
      </database>
      <layout>
        <user>user.xml</user>
      </layout>
      <forms>
        <login>
          <actions>
            <submit>
              <params>
                <controller>account</controller>
                <action>login-post</action>
              </params>
            </submit>
            <success>
              <params>
                <controller>account</controller>
              </params>
            </success>
            <error>
              <params>
                <controller>account</controller>
                <action>login</action>
              </params>
            </error>
          </actions>
          <fieldsets>
            <login />
          </fieldsets>
          <params>
            <name>login</name>
          </params>
        </login>
      </forms>
      <fieldsets>
        <login>
          <name>login</name>
          <elements>
            <identity>
              <type>text</type>
              <name>identity</name>
              <options>
                <value></value>
                <label>Username:</label>
                <order>1</order>
                <required>1</required>
                <allowEmpty>0</allowEmpty>
                <description>Enter your username in order to log into the application</description>
                <ignore>0</ignore>
                <attribs>
                  <id>login_identity</id>
                  <class>login identity input required</class>
                </attribs>
                <disableTranslator>0</disableTranslator>
                <validators>
                  <required>
                    <validator>NotEmpty</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                  </required>
                  <email>
                    <validator>EmailAddress</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                  </email>
                </validators>
                <decorators>
                  <element>
                    <decorator>ViewHelper</decorator>
                    <options>
                      <helper>FormText</helper>
                    </options>
                  </element>
                  <label>
                    <decorator>Label</decorator>
                  </label>
                </decorators>
              </options>
            </identity>
            <password>
              <type>password</type>
              <name>password</name>
              <options>
                <value></value>
                <label>Password:</label>
                <order>2</order>
                <required>1</required>
                <allowEmpty>0</allowEmpty>
                <description>Enter your password in order to log into the application</description>
                <ignore>0</ignore>
                <attribs>
                  <id>login_password</id>
                  <class>login password input required</class>
                </attribs>
                <disableTranslator>0</disableTranslator>
                <validators>
                  <required>
                    <validator>NotEmpty</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                  </required>
                  <base64>
                    <validator>Regex</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                    <options>
                      <pattern>#[A-Za-z0-9/+]+[=]{,2}#</pattern>
                    </options>
                  </base64>
                  <length>
                    <validator>StringLength</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                    <options>
                      <min>43</min>
                      <max>44</max>
                    </options>
                  </length>
                </validators>
                <decorators>
                  <element>
                    <decorator>ViewHelper</decorator>
                    <options>
                      <helper>FormPassword</helper>
                    </options>
                  </element>
                  <label>
                    <decorator>Label</decorator>
                  </label>
                </decorators>
              </options>
            </password>
            <stealth_salt>
              <type>hidden</type>
              <name>stealth_salt</name>
              <options>
                <value></value>
                <order>0</order>
                <required>1</required>
                <allowEmpty>0</allowEmpty>
                <ignore>0</ignore>
                <disableTranslator>1</disableTranslator>
                <validators>
                  <required>
                    <validator>NotEmpty</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                  </required>
                  <base64>
                    <validator>Regex</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                    <options>
                      <pattern>#[A-Za-z0-9/+]+[=]{,2}#</pattern>
                    </options>
                  </base64>
                  <length>
                    <validator>StringLength</validator>
                    <breakChainOnFailure>1</breakChainOnFailure>
                    <options>
                      <min>43</min>
                      <max>44</max>
                    </options>
                  </length>
                </validators>
              </options>
            </stealth_salt>
          </elements>
        </login>
      </fieldsets>
    </general>
  </default>
</config>